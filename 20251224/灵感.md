# 灵感笔记 - {{date}}

## 💡 创意点

## ⚠️ 遇到的问题

- 创建引用前应该书写关键的架构说明
    - 收集了架构模板后续可以直接进行提交

- 在文章中插入配图有时候缩放会失真，导致图片模糊，可读性差
    - 尝试使用ai限定限制在a4页面80%，然后给出最终输出大小
    - 目前通过提示词进行修改生成
    - 后续可使用mcp与模型进行交互，不断与drawio进行交互，从而实现自动生成符合要求的图片
- 了解xml和mermaid等语言的能力边界和问题：
    - xml复制但能精准控制元素大小格局
    - mermaid复制后不能直接修改大小，需要手动调整

## ✅ 解决方案





## 📚 学到的知识


作为软件工程师，我非常认同架构说明书的核心目标是**指导开发**。一份好的架构说明书应该是开发团队的“作战地图”，而非摆设。

以下是我根据实践总结的软件架构说明书模板，按**从必要到可选**的重要程度排序。每个部分我都标注了其对于“指导开发”的核心价值。

---

### **第一梯队：绝对必要 - 没有这些，开发将无从下手或严重偏离**
这些是架构的骨架，定义了系统的核心约束和蓝图。

#### **1. 概述与目标**
*   **重要程度：必要**
*   **核心内容：**
    *   **系统概述：** 用一两句话说明系统是“什么”，解决“什么问题”。
    *   **业务目标：** 为什么建这个系统？（例如：提升交易处理速度至每秒1万笔，降低运维成本30%）。
    *   **架构目标与质量属性（非功能需求）：** 这是**架构的指挥棒**。必须明确优先级，如：高可用 > 可扩展性 > 低延迟 > 安全性 > 可维护性。指导所有技术决策。
*   **如何指导开发：** 让每个开发者理解“为什么这样设计”，确保日常编码决策与核心目标对齐。例如，若“可扩展性”优先级高，开发者在设计模块时就会避免硬编码，考虑水平拆分。

#### **2. 架构视图（核心蓝图）**
这是说明书的主体，必须包含以下至少三个视图。

*   **2.1 逻辑/组件视图**
    *   **重要程度：必要**
    *   **核心内容：** 展示系统由哪些**核心组件/模块**构成，以及它们之间的**职责边界**和**静态依赖关系**。使用组件图。
    *   **如何指导开发：** **直接定义了代码库的一级目录结构、模块划分和团队分工**。开发者清楚自己负责的模块在哪，需要调用谁，被谁依赖。

*   **2.2 运行时/进程视图**
    *   **重要程度：必要**
    *   **核心内容：** 展示系统在**运行时的关键场景**中，各个组件/服务之间如何交互。使用序列图或活动图，描述核心API调用、消息流、数据流。
    *   **如何指导开发：** **指导接口（API/消息）设计，明确交互协议和数据格式**。开发者知道模块在运行时如何“对话”，是编写API和消息处理代码的直接依据。

*   **2.3 部署/物理视图**
    *   **重要程度：必要**
    *   **核心内容：** 展示软件组件如何映射到**硬件/云基础设施**（服务器、容器、集群、区域）。标明节点类型、数量、网络拓扑、负载均衡策略。
    *   **如何指导开发：** **指导环境相关配置、容错和伸缩性实现**。开发者理解代码将运行在什么环境中，从而在编码时考虑网络延迟、无状态设计、配置外部化等。

#### **3. 关键技术决策与约束**
*   **重要程度：必要**
*   **核心内容：**
    *   **技术栈：** 明确的语言、框架、核心中间件（如Spring Boot, React, Kafka, Redis, MySQL）。
    *   **关键选型理由：** 简要说明为什么选A不选B（如：选Kafka是因为需要高吞吐的日志流处理）。
    *   **外部约束：** 必须遵守的合规、安全、技术债务或遗留系统集成要求。
*   **如何指导开发：** **框定了技术边界，避免团队在技术选型上浪费时间和产生分歧**。开发者直接在其基础上进行具体编码。

---

### **第二梯队：高度推荐 - 能极大提升开发效率和系统质量**
这些是架构的血肉，提供了重要的设计和实现规范。

#### **4. 数据架构**
*   **重要程度：高度推荐**
*   **核心内容：**
    *   **数据模型：** 核心实体关系图或领域模型。
    *   **数据存储策略：** 数据库分库分表策略、读写分离、缓存策略（缓存位置、更新机制、失效策略）。
    *   **数据流：** 关键数据如何在系统间流动、同步。
*   **如何指导开发：** **指导数据库Schema设计、缓存代码的编写、以及数据访问层的设计模式**。是DAO层和Service层设计的基础。

#### **5. 接口契约（API设计）**
*   **重要程度：高度推荐**
*   **核心内容：**
    *   **核心API清单：** 不是全部，而是**关键、跨团队、对外的API**。
    *   **API规范：** 采用REST/GraphQL/gRPC？定义统一的**错误码格式、分页规范、鉴权方式、版本策略**。
    *   **消息格式：** 如使用消息队列，定义关键Topic和消息体Schema。
*   **如何指导开发：** **前端/后端/测试团队并行开发的契约基础**。开发者在实现前就已明确接口细节，极大减少联调返工。

#### **6. 横切关注点设计**
*   **重要程度：高度推荐**
*   **核心内容：**
    *   **安全性：** 认证、授权、加密、审计日志的实现框架和关键点。
    *   **可观测性：** 日志格式规范（结构化日志）、核心监控指标、链路追踪方案。
    *   **异常处理：** 全局异常处理策略、重试/熔断/降级机制。
    *   **配置管理：** 配置的存储、分层、热更新策略。
*   **如何指导开发：** **指导开发者在编码中实现非业务功能的一致性**，确保系统在安全、运维等方面质量统一。

---

### **第三梯队：可选补充 - 为特定复杂场景提供深度指导**
这些部分在系统复杂或存在特定风险时非常重要。

#### **7. 架构演进与兼容性**
*   **重要程度：可选（复杂系统必备）**
*   **核心内容：** 系统灰度发布方案、数据库迁移策略、API向后兼容性承诺。
*   **指导开发：** 在涉及变更和升级时，指导开发者如何平滑过渡。

#### **8. 容量规划与性能预算**
*   **重要程度：可选（性能敏感系统必备）**
*   **核心内容：** 关键链路的预期QPS、延迟、资源消耗（CPU/内存）预算。
*   **指导开发：** 开发者在进行性能优化和代码Review时有量化目标。

#### **9. 风险与应对措施**
*   **重要程度：可选**
*   **核心内容：** 识别技术风险（如新技术选型、性能瓶颈）和缓解方案。
*   **指导开发：** 让团队对潜在问题有预案，在开发中提前规避。

---

### **给工程师的总结与建议**

1.  **核心原则：** 架构说明书的核心读者是**开发、测试和运维工程师**。必须**实用、可执行**。
2.  **格式不重要，核心视图和决策才重要。** 可以用PPT、Markdown、Wiki、甚至白板拍照，但必须包含第一梯队的内容。
3.  **保持更新：** 架构是演进的。在代码仓库中维护此文档，并将重大架构变更与代码提交关联。
4.  **模板使用顺序：** 启动新项目时，按上述顺序思考和填充。先明确**目标**，再绘制**蓝图**，然后确定**技术栈**，最后补充**规范和细节**。

**最终检查清单（用于评估你的架构说明书是否合格）：**
- [ ] 一个新加入的资深开发者，能否仅凭这份文档，就对系统有清晰认识，并知道从哪里开始着手开发？
- [ ] 开发团队对“系统由哪些核心模块组成”和“它们如何交互”是否有共同且一致的理解？
- [ ] 文档中的关键技术决策，是否能回答开发中遇到的“我们应该用哪种方式实现？”这类问题？

遵循以上模板和原则，你产出的将不再是一份“ shelfware”（搁置文档），而是一份真正能**指导开发**、凝聚团队的技术蓝图。